<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì—°ì„¸ëŒ€ ë©´ì ‘ ëŒ€ë¹„ íƒ€ì´ë¨¸</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; margin-top: 50px; }
    #phase { font-size: 24px; margin: 10px; }
    #timer { font-size: 48px; margin: 20px; }
    button { padding: 10px 20px; font-size: 18px; margin: 10px; cursor: pointer; }
  </style>
</head>
<body>
  <h1>ì—°ì„¸ëŒ€ ì œì‹œë¬¸ ë©´ì ‘ ëŒ€ë¹„ íƒ€ì´ë¨¸</h1>
  <div id="phase">ì¤€ë¹„ë˜ë©´ ì‹œì‘ ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”</div>
  <div id="timer">00:00</div>
  <button id="startBtn">ì‹œì‘</button>

  <!-- ì•ŒëŒ ì†Œë¦¬ -->
  <audio id="beep-sound" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>

  <script>
    let timerElement = document.getElementById("timer");
    let phaseElement = document.getElementById("phase");
    let startBtn = document.getElementById("startBtn");
    let currentTimer;

    function playBeep() {
      let sound = document.getElementById("beep-sound");
      sound.currentTime = 0;
      sound.play().catch(() => {
        // ìë™ì¬ìƒ ì°¨ë‹¨ ë•Œë¬¸ì— ì‹¤íŒ¨í•´ë„ ë¬´ì‹œí•˜ê³  íƒ€ì´ë¨¸ëŠ” ê³„ì† ì§„í–‰
        console.log("ì‚¬ìš´ë“œ ì¬ìƒ ì°¨ë‹¨ë¨ (ë¸Œë¼ìš°ì € ì •ì±…)");
      });
    }

    function startTimers() {
      startBtn.disabled = true; // ì¤‘ë³µ í´ë¦­ ë°©ì§€
      runTimer(8*60, "ì œì‹œë¬¸ ì½ê¸° (8ë¶„)", [
        {time: 60, message: "â° 1ë¶„ ë‚¨ì•˜ìŠµë‹ˆë‹¤"},
        {time: 10, message: "â° 10ì´ˆ ë‚¨ì•˜ìŠµë‹ˆë‹¤"},
        {time: 5, message: "â° 5ì´ˆ ë‚¨ì•˜ìŠµë‹ˆë‹¤"}
      ], () => {
        playBeep();
        alert("ğŸ”” 8ë¶„ ì¢…ë£Œ!");
        runTimer(10, "ë‹µë³€ ì¤€ë¹„ (10ì´ˆ)", [], () => {
          playBeep();
          alert("ğŸ”” ì¤€ë¹„ ì‹œê°„ ì¢…ë£Œ!");
          runTimer(5*60, "ë‹µë³€í•˜ê¸° (5ë¶„)", [], () => {
            playBeep();
            alert("ğŸ”” ë‹µë³€ ì‹œê°„ ì¢…ë£Œ!");
            startBtn.disabled = false; // ë‹¤ ëë‚˜ë©´ ë‹¤ì‹œ ì‹œì‘ ê°€ëŠ¥
          });
        });
      });
    }

    function runTimer(duration, phaseName, alerts, callback) {
      clearInterval(currentTimer);
      let timeLeft = duration;
      phaseElement.textContent = phaseName;
      updateDisplay(timeLeft);

      currentTimer = setInterval(() => {
        timeLeft--;
        updateDisplay(timeLeft);

        alerts.forEach(a => {
          if (timeLeft === a.time) {
            playBeep();
            alert(a.message);
          }
        });

        if (timeLeft <= 0) {
          clearInterval(currentTimer);
          callback();
        }
      }, 1000);
    }

    function updateDisplay(seconds) {
      let min = String(Math.floor(seconds / 60)).padStart(2, "0");
      let sec = String(seconds % 60).padStart(2, "0");
      timerElement.textContent = `${min}:${sec}`;
    }

    // ë²„íŠ¼ ì´ë²¤íŠ¸ ì—°ê²°
    startBtn.addEventListener("click", startTimers);
  </script>
</body>
</html>
